using System;
using System.IO;
using System.Reflection;
using Base45Utility;
using NUnit.Framework;

namespace Base45Test
{
    public class Tests
    {
        [SetUp]
        public void Setup()
        {
        }

        [Test]
        public void SimpleEncodeBytesTest()
        {
            var base45 = new Base45();
            var messageText = "Hello world";
            var messageBytes = System.Text.Encoding.UTF8.GetBytes(messageText);
            var base45Encoded = base45.Encode(messageBytes);

            Assert.AreEqual("%69 VD82EK4F.KEA2", base45Encoded);
            var base45Decoded = base45.DecodeAsString(base45Encoded);
            Assert.AreEqual(messageText, base45Decoded);
        }

        [Test]
        public void SimpleEncodeStringTest()
        {
            var base45 = new Base45();
            var messageText = "Hello world";
            var base45Encoded = base45.Encode(messageText);

            Assert.AreEqual("%69 VD82EK4F.KEA2", base45Encoded);
            var base45Decoded = base45.DecodeAsString(base45Encoded);
            Assert.AreEqual(messageText, base45Decoded);
        }

        [Test]
        public void SimpleDecodeStringTest()
        {
            var base45 = new Base45();
            var base45Encoded = "%69 VD82EK4F.KEA2";
            var base45Decoded = base45.DecodeAsString(base45Encoded);
            Assert.AreEqual("Hello world", base45Decoded);
        }

        [Test]
        public void CompleteUtf8EncodeBytesTest()
        {
            var base45 = new Base45();
            var messageText = File.ReadAllText(Path.Combine(AssemblyDirectory, "Utf8TestFile.txt"));
            var messageBytes = System.Text.Encoding.UTF8.GetBytes(messageText);
            var base45EncodedFromBytes = base45.Encode(messageBytes);
            var base45EncodedFromText = base45.Encode(messageText);

            string expectedEncoded = @"/1ASEDZEDAECA443EF9Z9-KE7%EW34-$EY-D9442VCX9E  CE4404ET34QTA3S99KCY34GECBWEM-D8V82$N QE- 5ZD1JTABW5D44:.DV3E  CR44BECP9EDZCP9E7ECZ-D7WEBAFE44XED YCOSS-5OICGOSS-5OICGOSS-5OICGOSS-5OICGOSS-5OICGOSS-5OICGOSS-5OICGOSS-5OICGOSS-5OICGOSS-5OICGOSS-5OICGOSS-5OICGOSS-5OICGOSS-5OICGOSS-5OICGOSS-5OICGOSS-5OICGOSS-5OICG5C19Z9-KE7%EW34-$EM-D9RB5BHEGCVUMARP.OEEQD2XP%.DH34L$D-$E9.D1EC5 D04EF2D374LBG634OA7CA7E465W5D365C18UADZCSB8ZM80B9UPCQ$DIECNEDTVD.34JTABW5D44:.DV3EZEDU1DX3EU34.NA634C461R69440/D.345/DUPC6VCHE1PVDZEDQX5B$CSUER.CTVD.OE+EDC44% CZED  CH44M-D2IA*L8PF67:69440/DH44M-D6C960A$96G%69%6L96AC81/DH8FNHA5C1ZD1PQE3/D.345/DUPC6VCC:5JTABW51Q5$FFE EGPCM-DN4F-EDDZCZEDD44B$DXED.OECECRTCVQE6%EKPCB44V3EDZCAWEZEDN3DR44 $EG7DHEC5C19Z9AWE0$CIECOED.OECECRTCHOAQED:.D6$C8F7RC1374PCHQ34ZSS%%GOCCXW7ZBAY24M-DUSSDLIWSS$:J374-BHE44+45/85XW7WSSA4I%1DBDD1Q5WSS%AGWSSWDHJYGUF7 SSGBH SS4FHXW7WSSRPINYHWSSBNI SSXQHS64THMWSSY5LLRO*5QI34G64HYLLRO%5Q374JCHS64ONMOP5RC1374BYG3742NH374BYGQSS+8GYSSCKGSSSVXKYSSCKGSSS LJYSSCKGSSS*%JYSSCKGSSSOKG374XNHH34944374.HHA44374/HHB443741IHC443747IH374WNH374B6H.24MA8VSSUWIHG8OP5RC1734S99KMG034 34QSSCKGVSS7WH2G6QSSELG1Q59HAXW7%Q6R/6DSDIHL374DYH734646L44EZDQD1ZEDP3D+EDBWEYPC9440/DC44OEDBWE-3EGECQEDNPE5C1Y24BXO2DD/%OG/D*LP*WP50E%3LWTG%HJ*LP5UDX:C-JJ6BH-LPCYEEJMN64/HJ/5ESMH%GD.AH/%O3RP0-DY241CB9RB8DH06IPQE*XDIYI2ZB1441$C344MMDATJ2ZB144Y3EOCC9RB2BH:5EMBIVLPDYBFD1 6A8F7RC1.24L45$SSAUMR95$SSFXM6-H7+AD:5USS8AI/*AY24374NZHUSSAEI5-HUSSRPI6-HWSSF2HVBHYSSCUGICG$SS%2IK+H SS-8HSD1OED5$CS44%FFY3EVKEL9E3EFZEDO44PVDZEDS44B$CSUER.CTVDNPE5C1Y240TS: I%+I0TSAEI%+I0TSAEI%+I0TSAEI%+I0TSAEI%+I0TSAEI%+I0TSAEI%+I0TSAEI%+I0TSAEI%+I0TSAEI%+I0TSAEI%+I0TSAEI%+I0TSAEI%+I0TSAEI%+I0TSAEI%+I0TSAEI%+I0TSAEI%+I0TSAEI%+I0TSAEI%+I0TSAEI%+I0TSAEI%+I0TSAEI0-IRC1374*+IY24Y24Y24Y24Y24Y24Y24Y24Y24Y24Y24Y24Y24Y24Y24Y24Y24Y24Y24Y24Y240TS5FIY240TSRFIY24OSSEMKOSSCCJZEDG3DR*CQBG9440/D374TBGGVCZ$ETVDOSS*%JKFE24E6$CY24Y24Y24Y24374*+IRC1374*+IY24Y24Y24Y24Y24Y24Y24Y24Y24Y24Y24Y24Y24Y24Y24Y24Y24Y24Y24Y24Y240TS5FIY240TSRFIY24OSSEMKYN8.KE3EFEEC14EKWE/3E+8DNPE374TBG82BOSS1IJDZCYJC1$CG445$CR*CUBG374*+IRC1374*+IY24Y24Y24Y24Y24Y24Y24Y24Y24Y24Y24Y24Y24Y24Y24Y24Y24Y24Y24Y24Y240TS5FIY240TSRFIY24OSSEMKNT9BWEZ-DL96EEC14EKWE/3E+8D9440/D944IPC1$CLWEUF78156 MY240TS5FIY240TSRFIY24Y24Y24Y24Y24Y24Y24Y24Y24Y24Y24Y24Y24Y24Y24Y24Y24Y24Y24Y24374*+IRC1374*+IY24374ZBG374RBG6VC8%EJQE+8DOSSJAJOSSD0K2/DNXO89D2%EN3DDLFOED+8D 0ETBGY24Y24Y24374*+IRC1374*+IY24Y24Y24Y24Y24Y24Y24Y24Y24Y24Y24Y24Y24Y24Y24Y24Y24Y24Y24Y24Y240TS5FIY240TSRFIY24OSSEMKOSS9BK374YBG1Q5OSSACM374ZBG1Q57P6KBG Q6374LBG1Q5WSSYLIF/5MW6374OYG1Q5OSS30LY24Y24374*+IRC1374*+IY24Y24Y24Y24Y24Y24Y24Y24Y24Y24Y24Y24Y24Y24Y24Y24Y24Y24Y24Y24Y240TS5FIY240TSRFIY24OSSEMKSB8ZM80B9HQEN.CRWES446$C9VE6341VDIVF534.0A1Q5257Y24Y24374*+IRC1374*+IY24Y24Y24Y24Y24Y24Y24Y24Y24Y24Y240TS9:L YI:SS9DG YI:SS9DG YI:SS9DG YI:SS9DG YI0TSQ0MY24Y24Y24Y240TS5FIY240TSRFIY24OSSEMKAWEDZC8$C0LER44ZFF:JCVUD374%YI634%Q6KA7374HNG374%YIY24Y24Y24Y24374*+IRC1374*+IY24Y24Y24Y24Y24Y24Y24Y24Y24Y24Y240TSCGM YI:SS9DG YI:SS9DG YI:SS9DG YI:SS9DG YI0TSC6MY24Y24Y24Y240TS5FIY240TS5QJ%+I0TSAEI%+I0TSAEI%+I0TSAEI%+I0TSAEI%+I0TSAEI%+I0TSAEI%+I0TSAEI%+I0TSAEI%+I0TSAEI%+I0TSAEI%+I0TSAEI%+I0TSAEI%+I0TSAEI%+I0TSAEI%+I0TSAEI%+I0TSAEI%+I0TSAEI%+I0TSAEI%+I0TSAEI%+I0TSAEI%+I0TSAEI6-I5C1K19$ CJOD+45M-DQ7A4WDHWE5/D5OC8F7RC1-34+8DS34ZKE/ C944G/D+8DH D5C1Y24O5Q9OSFNM+5Q56QTAQLAQ9OSTAN:4N4FH8OSZCG8DGD:NT64.ZG9:N56QS646SNE:NSAQ:5QRC1T64NZGQBOCAOT64%TGYCGNLMFGN1MNQBOCAOT64.ZG9:N56QT64OZGKIG7BO4*ND:M*IGA:NOP5Y24NAQ9OSFNM+5Q56QTAQLAQ9OSTAN:4N4FH8OSZCG8DGD:NT64.ZG9:N56Q2746/NSAQ:5QRC1T64YCGQBOF:NS64N*N7:NS64SRMC:N%5QS644*ND:MOZG*IG6:N.5Q16QT64.ZG9:NS64EXMP9O- 5RC127465O65QKAQAOSD7OOAQ9OS/BM26Q9OS1MNWRNWRNNLMIXNTHM*5Q+5Q%5Q36Q46Q9OS+WMZ:ND6NY24OAQBOS/4N-+NBOSL5OA.IIXN$XNA:N56QTAQ56QT64.ZG5:N274K%N.5QLAQ9OS7HMY2426Q%5Q9OS41NNAQ9OS$FM-+NKAQLAQBOS:4NNZGTHM8OSYCGZ:NR%MKIGC:M2MN/IHN*N8:N56Q:5QRC1T64Q7H.LM-9OLAQ.5Q1Q59OS30LRAQ%5QBOS.2JKIGU+M27465OA5Q36Q.5QPAQ06Q.5QLAQ16Q9OSUHM5C1Y24Y+8+3E944R44I9EZ CG7DX3EP340$C14EAWE1$C6$CH44M-DAWEDZCIS6G7DKPCG/D6%E3EF/G88F7RC1S64O9KI/NRAQ9OS41NOAQ%5Q9OS DI.ZG5:NT64YCGOLM*IGC:NNAQOAQ%5QOAQ%5Q9OSZ6N46Q76Q16QS64+WM1MN+WM90OI:NNAQ26Q.5Q16Q56Q1Q59OS30L8OSNZGZ:NR%MKIGD:MCKGAOS7BOLJIFGNTANZ:N.LM-9O76Q16QOP5Y249OSA-GNZGNLM-+NOAQAOSD7O.5Q8OS%FMCKGOAQ9OS/BMKAQLAQ9OSNLM+WM4*NOLMNZGTHM8OSZCGYCG7BO9RM$XN8:NSAQTAQS64WRN.LMB:N2747/NOAQ%5Q56QT64ZCG*IGD:NMAQT64NZGQBOF:NMAQRC1S64$XNE:N+5Q76QPAQMAQS64QBOL/NMAQ274G$N26Q76Q9OSJXN/IHW3HOAQ76Q9OSXRNCKG46Q9OS9RM-+N+5Q9OS%FMQEG36Q9OS1MN+WM8BOA-GCKGKAQ.5QLAQ9OS41NOAQ76QBOSQ:KY24OAQ16Q46QTAQLAQ9OSD:M$TGOLM$TGFGNNLM7INR5Q9OSTANIXN2MNZCGYCG7BO-+N9OSLIG*IGSAOS64+WM1MN+WMZ:N7BON*N8:N56Q76QPAQMAQ1Q5OAQ9OS/BM-5Q9OSFNMKAQLAQ9OSNLM+WM4*NOLM.ZG65OC24Y24.5Q8OS%FMCKGOAQ76QBOS/3LNZGD7OKAQLAQ76Q9OSC:MWRN7BO :NNZG-HMY249OSC/K$TGYGN65O2747/NKAQTAQMAQS64N*N9:NT64YCGC:M2MNBUGE:N46Q.5Q06QAOSD7O%5Q9OS DINZGQBOB:NRC1T64ZCG*IGE:NOAQ.5QLAQ76Q56QS64WRNNLM6SNSAOMAQT64$TG6SN8:NSAQ%5QNAQ06Q%5Q16QS640*M8:N76Q56QI$576Q9OSZDI0*M8:N56QS64QBOO/N56Q274K$N36Q36Q76QS644*N7BO7IN-5Q76Q26Q76QBOS/3L$TG1MNJ+NY2476Q8OSTHMOAQ9OS/BMOAQ76Q16Q%5QBOS/3LNZGTHM36Q9OS+WM+WM7BO :NNZGD:MCKG8OSEMKOAQ9OSQ%M-+N9OSMJI8DGE:N06Q.5QNAQ16Q56Q1Q5KAQ.5QLAQ9OS41N8OST9LCKG*5Q76QPAQ36Q.5Q9OSIXND:M$TGFGNNLMJINRC1S64QBOI/NRAQ9OS41NOAQ9OSQ%M-+N76Q9OS.2J$TGNLM-+NKAQ%5QLAQ16QNAQOAQ9OSNLM :NNZGD:MCKG9OSLJIN*N-9O56Q274H$N46Q%5QLAQOAQ9OSNLMZ:NC:M1MNA-N274W$N+5Q9OSAZN-5Q9OSDTM2747/NOAQ16QS64N*N8:N56QRC1T64YCG8BO.ZG65O274W$N66QBOS+1H-+NOAQBOSW3HKAQ9OS1MNIXNC:M7IN26Q%5Q9OS41NOAQ9OS/BM%5Q9OSMJI.ZGP9OMAQ274 $NRAQ.5Q16Q56Q274G$NNAQQAQ%5Q36QBOS:4NCKG26Q%5Q9OS41NR5Q9OSTANIXN2MNZCGYCG7BOJ+NY24OAQ16Q46QTAQLAQ9OSD:M$TGOLM$TGFGNNLMJINS64WRN.LMB:NS64N*N6:N36QAOSD7O8OSYCGXRNKIG1MNSRMSAOMAQS64QBOP%N-5Q%5Q-4Q274W$NKAQAOSD7O8OSZDI4*NQBOCAOS64EXM6:NLAQ1Q576Q9OS-9IKAQ9OSNLMIXNNLMUHNY24+5Q9OS+WM+WM7BOZ:NC:M-+NOAQ%5QBOS/3L.ZG65O274G$N46QQAQ9OS2MNNZGD:MKIGNLMW3H56QBOS.3L-+N46Q9OS+WM :NNZG7BO7INKAQ9OS-WMYCGC:M2MN$TG4*NNLM7INOAQ76QBOS.3LYGN65O274K%N26Q%5Q56Q9OSFGNJ+NY24KAQLAQ76Q36Q%5Q*5Q.5QBOS-2J-+N8OSMKKN*N-9O56QS64V:MP%N56Q%5Q16QT64.ZG9:N56QT64ZCG*IGI:NOAQ:5Q56Q1Q59OSA-GZCG:IHCKGOAQ76Q9OSXRNCKGNAQPAQ46Q46Q9OSOLMQ7H8BOA-GZJGY24NAQ9OS :N$TG7BO4*NC:MA-N274W$N9OS$FM-+N+5Q9OS%FMQEGOAQ76QBOS/3LNZGD7O*5Q.5Q*5Q%5Q9OSUAN:IHCKG9OSMJI8DG6:NLAQ66QBOSAQGT64.ZGE:NOAQ.5QS64WRN.LMB:NT64YCGD:M*IGB:NT64NZGQBOCAORC1T64.ZGC:N56Q%5QT64NZG1MN5*N:IH*IGA:NNAQ.5QOAQ%5Q9OSZ6NOAQ16QMAQS64WRN.LMB:N2745/N56QT64OZG*IGE:NKAQ76Q56Q274W$N66Q9OS-WM%TGNZGNLM7INNAQ26Q76QKAQ.5QBOS-2JZ:NW3HKAQLAQ9OS/4N-+N-5Q9OS%MMY24OAQ9OSQ%M-+N8OSZCGLIG08H9:N56Q2742/NLAQ06QBOS:4NCKG9OSMJIYCG7BOYGN8:NNAQ06Q%5Q16Q1Q546Q9OSOLMNZGNLM1MN7BO-+N8OSMKK+WMQBOCAO46Q%5Q16QT64YCGD:M*IGB:NT64.ZGP9OMAQRC1T64NZGC:MIXND:MA-G.ZGP9OMAQ2743/N56QOAQ16Q56Q76QBOS.3L-+NKAQ76Q16Q.5QBOS.2J$TGFGNNLM7IN36Q9OS1MN+WM7BOA-N5C1Y2495Q:5Q46Q76QNAQ06Q9OS+WMZ:N8BOA-GOKGS64CVIZAO27465OK5Q36QPAQ56Q06Q16Q%5Q26Q9OSGGNZJGLD12$C$KEMED3.D5C1Y24Y+8+3E944.345/DUPC6VCB44-3EN.CZKE:.DDZCZEDS/E3WEBWE-3E8F7RC1274MSG-MS19J5TG-MS7/JPSG-MSX4J-MS9EI5TG-MS4QJKSG-MST.IOSG274MSG-MS9EISSG-MS9EI SG-MS7/JRSG274 SG-MS/ IMSG-MSWEJ$SG-MSRQK SG-MS9EI1TG-MSWEJKSG.345/DUPC6VC0 5SSG-MSSGK-MSZVJOSG-MS9EIRSG-MSUWI-MS-KKKSG-MS/ I SG-MS19JKSG-MSXFLXSG-MSAFKSSG-MS-KKXSGRC1274TSG-MS7/JWSG-MS:$KOSG-MSAFKOSG-MSL$J1TG-MSWEJKSG-MSF3JOSG274NSG-MS9EI$SG-MS9EI$SG-MSM%L SG-MS/ ILSG-MS9EINSG1Q5-MSAFKXSG-MSZVJOSG-MS4QJSSG-MS$ML-MSQPIKSG-MSWEJVSG-MS9EI SG-MS19JOSG-MS+JIKSG634346*96274VSG-MS9EI SG-MSRQK$SGOP5Y24-MSV*K274VSG-MS9EISSG-MSL$J1TG-MSXFLSSG1Q5-MSQPIOSG-MSAFKVSG-MS9EIWSG-MSWEJKSG-MSXFLSSGI$5-MSIKJXSG-MSL$J+SG-MS/ I SG-MS/ IWSG-MS5RLSSG-MS-9I-MSXFLOSG-MSBGMTSG-MSAFKOSG-MS+JI$SG274OSG-MSAFKRSG-MS9EINSG274VSG-MS-KKXSG-MS:$KUSG-MSWEJXSG-MS6GKY24-MS/ I-SG-MS-KKYSG-MS/ I SG-MSRQKOSG-MS+JI$SG274SSG-MS-KKOSG-MSX4J-MSCVIKSG-MSAFKMSG-MS/ ILSG-MSXFLSSG274 SG-MS7/JMSG-MS7/J SG-MSWEJ1TG-MS9EIKSG274SSG-MSL$J%SG-MS/ I SG-MSL$JOSG-MSRQKSSG274NSG-MS-9I0 AOEDV3EQZC-MSVAJRC1274SSG-MSL$J%SG-MS/ I SG-MSL$JKSG-MS5RLSSG-MS7/JWSG-MS9EIUSG-MSWEJQSG-MS9EI1TG-MSWEJKSG274NSG-MS-9I-MS4QJXSG-MSIKJKSG-MS4QJSSG-MSF3JKSG-MS5RLSSG-MS8AI.345/DUPC6VC0 5SSG-MSSGK-MSQPIKSG-MSZVJXSG-MS2ALOSG-MSL$JOSG-MS+JIKSGRC1274XSG-MS%3KOSG-MSAFKKSG-MS5RLSSG-MSDWKUSG274$SG-MSWEJ$SG-MSRQKOSG-MSZVJOSG-MS+JI$SG-MS8AI274NSG-MS-9I-MSQPIKSG-MSZVJXSG-MS2ALOSG-MSL$JOSG-MS+JISSG-MSX4J-MS%3K SG-MS7/JMSG-MSAFKKSG-MSZVJOSG-MS+JI:SG-MSVAJ274:SG-MSAFKSSG-MS:$K%SG-MS/ ILSG-MSXFLSSGOP5Y24-MSRQKOSG-MSU/K$SG-MSRQKOSG-MS+JISSG-MSSGK-MSCVIKSG-MSZVJ*SG-MSXFLKSG-MST.IOSG-MS+JIKSG-MS-KKKSG274NSG-MS-9I-MSZVJ SG-MS9EIPSG-MS9EIUSG-MS/ IWSG-MS7/JPSG-MS9EIWSG274TSG-MS7/JVSG-MS%3KSSG-MSDWK%SG-MS/ I SG-MSDWKUSG274$SG-MSWEJ$SG-MSRQKOSG-MSZVJOSG-MS+JI:SG-MSXAJ5C14JAZQEMED3.D5C1Y24Y+8+3E944.345/DUPC6VCB44-3EN.CZKE:.DDZCZEDS/E3WEBWE-3E8F7RC1U64T8J+FM CGE:M.WMIGNNIG9OG CGIGN$CG*TG4MN8OGF:MNIG7WH%LQEHQIHQ:LQ9HQ%LQU64$:N/BMQGQEHQ%LQ7MQ*LQ+LQ6MQU644$JE:M05NT%M*TG$:N+FM CGN5OS%M%:N+TGO/HWGQNHQMHQ-LQEHQ$LQEHQMHQ/LQHHQ6MQU649BO51OY240 AOEDV3EPZCU64YRNO5O8OGO5O CG+FMA4I%LQNHQ%LQ*LQNHQHHQ*LQ%LQ7MQ634346*96U646*N+FM$CG8OG/BM1A6MA7U64.WMN5OS%M/BMBHQU644$J*FM3MN%:N.1HI+MBHQU64+UIF:M CG6*N*FM$:NHGNZCNRC1U64WPJN5O%:NPZGF:M CGE:M%:N.1HIGNA4I%LQNHQAHQEHQ$LQEHQ*LQV64EDHIGN CGN5OYRNHGN7INJHQ$LQ+LQCHQV64Y-HZRNMIG9BOF:M$CG8OGN5OFNMOHQNHQY24BHQNHQOHQ$LQNHQ%LQ9HQLHQU64.WMKXNN5OPLM*FMLXN3 H$:NN5O.WM51OY24UGQMHQ*LQEHQ$LQMHQEHQ*LQ9HQU64LCN0 AOEDV3EPZCU64KXNN5OYRN*FMKXNHGNVAN+FM.1HHGNLCNHHQU64HGN%:N8OGF:M CG$:N+FM.1HHGNN5O$:N*FMKXNHGNVAN+FM.1HHGNXCNU64BRMN5O9BOKXNO5O0JHE:M$:NIGNO/HHHQRC1U64ABO CGHGN6*NE:M$:NE:M$:NIGNO/H0 AOEDV3EDZCBHQV64 CG*FMVANKXNIGNS7H%:NIUHF$GNHQOHQEHQ$LQ9HQ/LQHHQNHQMHQMHQ3MQ.LQV64MIGIGNNIG8OGE:M6*N+FMF$GHHQU64ABO CGN5O/WM CG*FM6*N6*N%:NIUH% GY24OHQ$LQHHQKHQNHQFHQEHQMHQHHQ7MQ.LQ1Q50MQ$LQHHQ-LQ*LQ9HQ.LQ1Q5BHQEHQ$LQ%LQ*LQJHQEHQU64LCNLHQMHQNHQCHQNHQ7MQGHQ3MQ:LQMHQ3MQ.LQU64YRNN5O6*NABO4 HL2I8OGF:M CG%:NIUHF$G%LQHHQ%LQ*LQEHQLHQ9HQ.LQ- 5YD1 8D2DDK450N8X349$C: C734O955C1Y249Z8KPC1LESUE .C+3E944O44W3EKWE3EF-3E-34+8D*34+3ECECKPCN44:+C8UADZC8UAZKEDZC0O93/DGVCT$D.24OCCLN8ZED6$C YCY24RPCHECPQE-NCW/4CECS34Y$EZ.48F7RC13440W50W50W50W50W50W50W50W50W50W50W50W50W50W5JVF0W50W50W50W50W50W50W50W50W50W50W53X5RC1Y24174SKN174EKNIISK$JLKNIISHKJ2FNIIS:%M7FNIIS%4MVFNJISUDH7FNJIS7DGOFNIIS2BNLKNIIS7:LFFNJISOOG5FNIISCWKFFNJIS%IGOFNIISHKJOFNIIS-LMYENJIS7DGLFNIISZKH174CFNIISCWKUFNIISYVJSENJIS7DGSENIISWFLSENIIS7:LYENIIS3QJ*FNJIS2PHSENIISJMNMKNIISOOG FNJISGJH7FNJISAUGPFNIIS+KKLKNRC1174OFNIIS:%M8FNIIS4RLRFNIIS:7HSENIISILLVFNIISS.IHFNIIS:%MGFNJISJ HSENJISUDHRFNIISHKJPFNIISHKJMKNIISRRMEKNIIST/K4FNIIS-LM2FNJIS-ZG9FNY24Y24Y24174OFNIIS7:LYENIIS7:LYENIIS-ZGPKNJIS-ZG%ENIISCWKMKNJISOOGYENJISUDHDKNIISOOGJFNIISRRMDKNIIS3QJWFNIISYVJVFNIIS5.H+ENIIS%MMY24Y24IIS09JHFNIIS:7H7FNIIS-LM8FNIISE3J$FNIIS7:LTENIIS-LM7FNIIS09JZFNJIS7DG9FNJIS:7H7FNIIS09JZFNJISUDHCFNIISG5NLKNIISW3HY24Y24Y24Y24Y24IIS3QJMKNIISRRM7FNJIS7DGFFNIIS2BNRFNIIS:7HZENIISG5NYENIIS1ALYFNIISYVJHFNIIS:%M3FNJIS7DG9FNJIS:7H7FNIISHKJVFNIIS%IGPFNIISHKJWFNRC1174FKNIIS%4MZENIIS:%MOKNIISHKJDKNIISCWKZFNIISQQKSENIIS09JVFNIIS$3K5FNIIS-LMLKNIIS1ALPFNIIS-LMLFNJIS7DGFFNIIS2BNRFNIIS:7HFFNIISFNMY24Y24Y24Y24IISZWLFFNIISRRMGFNIISUDHUFNIISD2HLKNIISRRMFFNIIS. I$ENIIS-LMLKNIIS1AL3FNIIS-LMLFNIIS4RLXFNIIS-ZGVFNIISG$HY24Y24JIS7DGPFNIIS+KK$FNIIS7:L7FNIISOOGVFNIIS3QJHKNIIS4RLHKNIIST/KLKNJIS7DGOFNIIS2BNRFNIISUDHWFNIIS%IGDKNIIS-ZGPFNIISFNMY24Y24174HFNIIS-LM8FNIISZWLFFNIISRRM9FNJISUDHWFNJIS7DGTENJISGJHWFNIIS+KKWFNJIS7DGJFNIISQQKRFNIISRRMOFNIIS-LM+ENRC1174BFNJISUDHWFNIISQQKRFNJISGJHRFNIIS:7HRFNIISXGNMKNIISHKJGFNIISXGNEKNIISQQKSENJISAUGPFNJISGJHEKNIISS.ISENIIS%IGVFNIIS5GJY24Y24Y24Y24174GKNIIS2PHMKNIIS4RLWFNIIS1AL7FNIIS-LMMKNIISHKJDKNIISYVJKKNIISHKJ$ENIISHKJLFNIISHKJ$ENIIS2BNLKNIISHKJ$ENIIS1AL7FNJISAUGZENRC1Y24174CFNIIST/KVFNIISHKJJFNIIS:%M ENIISXGNGFNIIS%IG%FNIISQQKSENIISU:MSENIIST/KVFNIIS3QJSENJISUDHRFNJIS7DGPFNIISS.I%FNY24Y24Y24Y24Y24IIS2PHLKNIISRRMYENIIS7:LWFNJIS7DGCFNIISWFLZENIISCWKYFNIIS:7HPFNIISHKJWFNIISN9KMKNIISRRMHFNJISGJHRFNIIS:7HHKNIISZWLMKNRC11743FNJISGJHRFNIIS:7HHFNIIS3QJHFNIISRRMXENJISUDHWFNIISN9KVFNIISHKJZENIISHKJ8FNIISCWKHFNIIST/KVFNIISEMKY24Y24Y24Y24Y24IIS/$KIKNIISZWLWFNJISAUGVENIISCWKVENJISGJHXFNIIS2PH*FNIIS%IG*FNJISGJH8FNIISCWKHFNIIST/KVFNIIS:7HSENJIS7WHIISZ5MRC1.248UADZC0EC44EDZC+ED944S44K4F9X5*3E1%EM-D7WEBAFI$5PC9B44+3E%JC5/D3/DB44 8DVKEZPC5$C.OEGECDZC 8D0/DTVD5TCY24UPC3LEZ CEWEFEFS44+8DK44ZED6$CN44:+CAWEDZCLQEUPC0/DB44*3E1%EM-DOQE34ESVDA44DZCAECSED1/DRTCE4FAWES44+8DRC1 44B44 8DVKEZPC5$C944:JCO/ER$55C15Z8:8D/3EMED3.D5C1Y24T7A44E5$C3KCH44M-DAWEDZC9C8 8D*KE-NCPVD3/DY$E93D8F7RC1274RCH1NSZVJRTH274SNH4NS8:LGIH1NSXFLWCH274HNH5NSHJHGCH274SNH4NS8:L NH1NSBGMWCH6NS$LKY242NSU/KZBH274*NH1NSVDHPNH274XNH3NST.IUTH3NSAFK0IH2NSWYM2NSAFKGHH1NSWEJ0ZH3NS7/JX+HRC1274PYH5NSH*K4NS WLWBH2NS:$KEIH274BHH1NS7/J5ZH3NS:QI3NS9EI+SH6NS$LKY244NSBGMOBH274.HH1NST.I$BH1NS5GJ2NSS-G1IH2740IH4NS8:L0ZH5NS0SK3NST.I3ZH2NSI+M2NSAFKLYH4NSBGMWBH4NS6.HX+HRC1274MTH3NSAFKC+H274ZSH1NSVDH8CH2NS1TM2NSAFKFHH2NSVXK3NSAFKRTH2NSEXM+CH1NS7/JX+HRC1274SNH4NS8:L5ZH274.HH2NSAFKZBH274XTH4NSLQH2NSBGM3CH2NSEXMX+HRC1274TCH2NSBGMJCH5NSHJH4CH274RTH4NSBGMJCH5NS6.H4CH6NS$LKY242NS8DGWCH274.HH2NS8DGWCH6NSH*K4NST.IHNH2NS*IGZBH1NS%$H2NSAFKXNH5NS6.HKCH274RTH1NS.ZGXTH1NS6.HX+HRC1274ZTH1NS+*L2NSRQKPTH2NSU/KOCH274SNH3NST.I.HH1NS1TM4NS WLWCH1NS8:LX+HRC1274RCH4NS%$H3NSU/KHNH4NSBGM1IH2NSTHM3NSU/KHNH5NSF$G3NSU/KHNH4NS/BM5NSHJHJCH2NS:$KEIH274SNH4NS8:LDIH4NSEXMUTH1NS8:L8CH6NS$LKY243NSU/KQYH4NSL$JOCH274MTH3NSXFL7+H2NSBGM+SH3NSG%I5NSHJHPCH1NSQ0M1NSEXMRTH4NSWEJOYH4NS%$H3NSAFKRTH4NSV:MOCH1NS7/JX+HRC1274MTH5NS$2IJCH2NS:$KIIH274 BH2NSDWK +H274:HH4NS WLNTH2NSI+M4NS8:LWCH2NSF$G2NSDWKPTH4NSJLLIIH274PTH5NSAFK$BH2NSS-GX+HRC1274GCH1NSNSL3NSXFL3CH6NS6.HGIH2NSI+M1NS6.HHYH3NSG%I1NSYUHA+H2NSEXMIIH6NS$LKY244NSCVI0IH4NS+*L1NSZVJUTH1NS5RLPTH274MTH1NSVDH+SH6NSH*K5NS6.HHNH4NSI+M4NS8:LCTH274RTH4NS%3KMCH1NS6.HX+HRC1274MTH3NSU/KWCH1NSYUH8CH274SNH5NSVDHKCH2743CH3NSNSL4NSXFLSNH1NS%3KMCH274SNH5NSVDHKCH274%SH1NS8:L*NH6NS$LKY242NSBGMHNH5NSYUH%BH274:HH2NSBGM8+H274DIH1NSWEJ$BH1NS41N2NSDWK8+H6NS$LKY244NSVDHXTH5NSS-GTBH2746CH1NS+*L2NSRQKUBH3NSG%I5NSXFLOCH1NSV:MTBH274SNH2NSV:MZBH1NSBGM+SH6NS$LKY243NSU/KQYH1NS8:LTBH3NSG%I2NSAFKC+H1NS WL+CH1NSF$G1NS6.H-NH2746TH1NS8:LOYH6NS$LKWD12%E6$C8F7RC1274BPJKNS2:IJNSEXM9PJJNS WLZOJ274ZOJJNS WL/TJ274BPJKNS2:IKNSQPIVOJKNS%3K5UJ274%OJJNSR1OJNSG4L+OJKNSX4JKNS4QJ*OJJNS+5ODUJKNS2:IJNS+5O%OJJNS.LMZOJJNSKMN5UJJNS5RL1PJKNS%3KVOJKNSX4JJNSKMNTTJJNS30LJNSG4L*OJ2749PJKNSF3JKUJJNS1SLRC1.24$1ARTC:Y8G3D+EDS7DV44:8DNPCS44VKEF/DXPCNED  CH44G/D82ENT9BWEM-DZKE2EC.OEL/4DZC%PC3ECAWES44 8DSUE+8DRC1A44$$EDZCAWE3EC ZDPVD0/DDZCB/D5LED9DX CYKE1%EV44-EDG7DAWEOCC82B QEHQERZCQ.4CECRTCF$DCEC.OEL/4DZCHQEPEDRC1S44 8DSUE+8DK44/ED  CH44M-DAWEDZCB/D5LE+8D:KEK44CECRTC1/DGECS44+8D:346$C7WE:KE+34X CP$5L85GD1VKEXEDTVD8F7RC13741JKBTS+IG.DKBTSRFIBTSO*N4DKBTSDLI3742JKBTSM$JADKBTS-JIFEKBTSCGMHDK374OJKBTSU.IFDK5C1Y24CTS7.HVDKBTS18HKDKBTS7INBTS7SN4DKBTSO/HBTSJKJKDKBTS+IGSDKBTSDLIBTS*3KODK3746DKBTS-JIUDKBTSUWIBTS7SNDDKBTSLMN8EK3741KKBTS%XNKDK374DDKBTSO/HBTS8/JODK374SDKBTSFXM6DKBTS3:JY24BTS/LM4DKBTS*3KKDKBTS3ALHEK3744DKBTSCUG9EKBTSP:JBTSLMN4DKBTS*3K8EK3741KKBTSRFIBTS29JKDKBTS VJDDKBTSL HHEK374ODKBTSLQHBTSJKJDDKBTSO/HBTSCUG+DKBTS29JDDKBTS+IGADK374GEKBTS+IGHDKRC1374HDKBTS4PHUDKBTS8/J1EK3746DKBTS7INBTSLMNKDK374DDKBTS18HHEKBTS VJFEKBTS7.H4DKBTS8/J5DK374FEKBTSRFIBTS4PHADKBTS%XN8DKBTSCKGBTSLMNKDK374+DKBTS8/JSDKBTS%XNXDKBTS+IG8DKBTS%XN5DKRC13744DKBTS8/JSDK374FEKBTSRFIBTS.KKDDKBTS-JIEDK374GDKBTSFXMQDKBTS8/JHEKBTSFNMCTS%2IDDKBTS29JODKBTSU.IUDKBTSRFIBTS%2IDDKBTS VJWDKBTSNSLBTS4PHXDKBTSFNMCTS+IGWDKBTSSFJY24CTS%2IDDKBTS29JODKBTSU.IUDKBTS-JI6EKBTSO/HBTS8/J4DKBTS7.HKDK374GEKBTS+IGHDK374UDKBTSU.IODKBTS5GJBTSV/KIDKBTSU.IWDK3746EKCTS.KK4DKBTS8/JUDKBTS-JI5DK374EDKBTSU.IQDK3744DKBTS8/JFEKBTSLMNNDKBTSMRJBTSJKJKDKC24Y24BTS.KKODKBTS%2IKDK374XDKBTSG%IBTSO8I+DKBTSP:JBTSJKJDDKBTSO/HBTSJKJ4DKBTS8/JSDK374XDKBTSU.I8EK5C1Y24CTSU.IADKBTS5GJCTS7.HVDKBTS18HKDKBTS7INBTS7SN4DKBTSO/HBTS+IGHDK374SDKBTS-JI4DKBTS5GJBTS+IGHDK3744DK374SDKBTSU.IODKBTS29J*DKBTS8/J4DKBTS4PHADKBTS%MMRC13742JKBTS: ISDKBTS2:ICTSZKHBTSJKJODKBTS8/J6EKBTSP:JBTS7.HKDKBTS+IGWDK374XDKBTSG%IBTS%2I4DKBTS7INBTSLMN4DKBTSP:JCTSZKHBTST-GWDKBTS6RL5DK374ODKBTSLQHBTS7.HFEKRC13740EKBTS*%JBTST-GWDKBTS6RLADKBTS$WLUDKBTS-JI5DK3747EKBTS+IGXDK374FEKBTS%XNKDK374DDKBTSO/HBTSO8IVDKBTS*3KDDKBTS4PH+DKBTS18HVDKBTS18HFEK374SDKBTS-JI4DKBTS5GJBTS+IG6DKBTSFXMXDKRC13744DK374SDKBTSU.IODKBTS29J*DKBTS8/J4DKBTS4PHADKBTSFNMCTSZKHBTS7.HDDKBTSEWKXDK374SDKBTS+IG.DKBTSRFIBTSCUGKDKBTSFNMBTS: IDDKBTS18HNDKBTS$WL5DK374GDKBTSLMNHDKBTS-JIADKBTSZUH5DK374XDKBTS*$IY24BTS29JKDKBTS VJVDKBTS5GJBTSQEGBTS4PHODKBTSZUHEDKBTS: I*DKBTS8/J4DKBTS4PHADK3744DKBTSO/HBTSLMNKDK374SDKBTS-JI4DKBTSJKJKDKBTS7WHBTSO8IDDKBTS-JIDDKBTSRFIBTSU.IEDK374DDKBTS29JODKBTS8/JGDKBTSU.IWDKBTS VJHEKBTS7INRC1374NDK374FEKBTSRFIBTS*3KQDKBTS+IGSDKBTS-JI8EK374$IKBTSV/KXDK374FEKBTSRFIBTS7SNDDKBTS%2ISDKBTSU.IGDK374ODKBTSLQHBTSFXMQDK3744DKBTS8/JDDKBTS-JIFDKBTSU.IQDKBTSO/HRC1374DDKBTSO/HBTSUWIBTSLMNKDK374HDKBTS4PHGDKBTS4PHADKBTS-JI9DK3744DKBTS8/JSDK374GDKBTS7INBTSV/KWDKBTSJKJ4DKBTS18HADKBTS6RL1EK374SDKBTS+IGWDKBTSJKJHDKRC1374:DKBTS+IGADKBTSW3HBTS8/JODKBTSP:JBTSJKJDDKBTSL H+DKBTS29J6DK374DDKBTS*3K5DK374ODKBTSX4JBTSLMNKDK374:IKBTSFXMWDKBTS*3KQDKBTSLMN6EKBTSO/HBTSJKJODKBTS8/JKDK374EDKBTSU.IQDKBTSFNMCTSLMN9EKRC1374GEKBTS4PHADKBTSW3HBTSLMNHEKBTS-JIEDKBTSU.IQDKBTSRFIBTSO8IHEKBTS7.HDDKBTSP:JBTS7.HKDK374XDKBTSG%IBTS29JKDKBTSO8IKDKBTS+IGXDKBTSCKGBTS-JIGDKBTSO8ISDKBTS+IGXDKBTS4PHDDKBTS+IGADKBTS18HFEKBTSCKGBTSLMN4DKBTS3:JY24CTS7.HVDKBTS18HKDKBTS7INBTS7SN4DKBTSO/HBTS+IGHDK374SDKBTS-JI4DKBTS5GJBTS+IGHDK3744DK374SDKBTSU.IODKBTS29J*DKBTS8/J4DKBTS4PHADKBTS%MMRC1.248UADZCR.C4LESUEUPC4%ETVDN44:+CE9EVKEM3DEEC99DN44:+C*E4O3489D+EDFWEHECO34GEC*3E6E49KCP34OED/PDF/DL85HD1+3EE9EZPCE44-3ESUELQETVDZPC EDM-DB$CBECP9EDZC7WEBAF8F7RC1M34/G8HS8 *8A69TH93T9M+9-6AFIAYTA8-AR7BWHBK/5*96DL6WW66:6M97Y240ECJPC% CC3DVED5QDO$D/3EHFE QEA%ET4F3GFG64RVKXKL1:MNCGT1HU2J83K*8KYKLW4N 6OY24OSSDVILBGOSSXEJTBGOSS8/JVBGOSSBFKZBGOSSH4L4CGSSS:PKTUIREK6GN-5OHNGS64LJI7PI%UIO I0LLNLM9RM+WMR%M4FHMGQNGQOGQPGQQGQ9HQAHQBHQCHQDHQRC1374OBHWSSQOGWBHSSS8/JICHWSS6RL/HHWSSP:JUSS-JIU0HUSSYFLL1HVSS0SK:SSAEI6 I0TS: I1-I1TS-JIL2J3TS7SNBIJG74G L+DUA0OXHIQSSPOG3%N4OSBOGU/K3QNULP2XP$SSR2I-DI.LMKSG5C1K19$ CBWE3/D.OEZEDU44GEC ED7%EK44CECP3D5EC6$C8F7RC1T34: C*VDV4404ESVD1Q5F5Q%5Q36Q:5Q46Q9OS-WMKIGTHM26Q9OS2MN$TG4*NU+M474ONGDYSGXMFSGDYS-IGJSG5C1.H8H8FJVCLECZEDU1DAECSED9/D1$CSUE7WE QENPEY24Y24Y24Y24Y24Y24Y24Y24Y24Y24Y24Y24Y24Y24Y24Y24Y24Y24Y24Y24Y241TS-8HY24Y24Y24Y24Y24Y24Y24Y24Y24Y24Y24Y24Y24Y24Y24Y24Y24Y24Y24Y24Y24Y24Y24Y24Y24Y24Y24Y24Y24Y24Y24Y24Y24Y24Y241TSREHY240TS: I%+I0TSAEIF-I0TSAEI%+I0TSX4J3743ZI:SS9DG YI:SSN%L YI:SS9DG7ZIY240TS9:L YI:SS9DGZZI:SS9DG YI0TSQ0M374M-I:SS9DG YI:SSN%L YI:SS9DGN-IY24:SSO8I$YI:SS+IG.ZI:SS+IG$YI:SS:QI3745ZI:SSRPI6ZI:SSRFIY240TSZ6N374 -I3746ZI:SSQAMAZI3743ZI:SSCGM7ZIY24Y241TSZKH0TS/LMR-I0TS/LMR-I0TSFXMS-I0TSOSMY240TS-JI3ZI:SS9DGH-I:SS9DG7ZI0TSRFI374%YI0TS: I%+I0TS3AL%+I0TS29J%YIY24:SSQOG++I0TSAEIJ-I0TSAEI/+I:SSCKG374%YI0TSDVI YI0TS+IG YI0TSG3J%YIY24:SSCUG3ZI:SS9DGO+I:SS9DG7ZI:SS/PG374EZI0TSCUGQ+I:SS5GJ374V-I:SSO*NT-I0TS7SNX+I0TSZGNNZI:SSO*NVZI374KZI0TSZUHSZIY24Y241TSLQH0TSTRMQ-I0TSTRMQ-I0TSFXMS-I0TSOSMY240TS-JI%YI0TSFNM0TS/LM%YI0TSRFI374%YI0TSRFIY240TS-JI%YIY24:SSQOG%YI374%YI374%YI:SSCKG374%YI0TSRFI:SS/PG0TS-JI%YIY24:SSCUG%YI374+-I374%YI:SS/PG3744ZI0TST-GS+I:SS:QIY240TSI+M374Y-I374EZI:SS4BNIZI374BZI:SSZGNFZIY24Y241TS7WH0TS/LMR-I0TS/LMR-I0TSFXMS-I0TSOSMY240TSBFKA-I374S-I3747-I0TS0SK374JZI0TSEMKY240TSP9KRZIY24:SSM$J6 I:SS9DG6 I:SS9DG6 I:SSVXK374JZI0TS$WL YI0TSQOG YI0TS$WLRZIY24:SSEWK9 I0TS-5O6 I0TSO*N9 I:SSNSL374CZI:SS VJDZI:SS LJY24Y24:SSL H+YI:SS/ZG7ZI374 +I3746ZI:SST-G-YI:SS:QI:SSLQH1TS%$H0TSTRMQ-I0TSTRMQ-I0TSFXMS-I0TSOSMY240TS-JI%YI0TSTHM0TSTRM%YI0TSRFI374%YI0TSRFIY240TS-JI%YIY24:SSQOG%YI374%YI374%YI:SSCKG374%YI0TSRFI:SS/PG0TS-JI%YIY24:SSCUG%YI374%-I374%YI:SS/PG374P1J1TS-JIQ1J1TSRPIR1J1TSDVIG1J1TSI9H:SSZKH374.YI374 +I374$+IY24:SSW3H:SSLQH1TS2/HY240TS-JIBZI:SS9DGE-I:SS9DGFZI0TSRFI374%YI0TS5QJ%+I0TS0%K%+I0TS8/J%YIY24:SSQOG1-I0TSAEIJ-I0TSAEI4-I:SSCKG374%YI0TSJKJ YI0TS9DG YI0TSM$J%YIY24:SSCUGBZI:SS9DGO+I:SS9DGFZI:SS/PG374P1J1TS-JIQ1J1TSRPIR1J1TSDVIG1J1TSI9H:SSZKH374.YI374 +I374$+IY24:SSW3H:SSLQH1TSX3IY240TS5QJ%+I0TSAEII-I0TSAEI%+I0TS*%J374BZI:SS9DG YI:SS1*M YI:SS9DGFZIY240TSCGM YI:SS9DG/ZI:SS9DG YI0TSC6M374P-I:SS9DG YI:SS1*M YI:SS9DGO-IY24:SS29J$YI:SS+IG5 I:SS+IG$YI:SSMRJY24Y24Y24Y24Y24:SS: IY+I0TSL HFZI374 +I374EZI0TS7.HZ+I:SSMRJ:SSLQH37491J1TSQOGB1J1TS/ZGD1J1TSF2HF1J1TS-8H";
            
            Assert.AreEqual(expectedEncoded, base45EncodedFromBytes);
            Assert.AreEqual(expectedEncoded, base45EncodedFromText);
            var base45Decoded = base45.DecodeAsString(base45EncodedFromBytes);
            Assert.AreEqual(messageText, base45Decoded);
        }

        public static string AssemblyDirectory
        {
            get
            {
                string codeBase = Assembly.GetExecutingAssembly().CodeBase;
                UriBuilder uri = new UriBuilder(codeBase);
                string path = Uri.UnescapeDataString(uri.Path);
                return Path.GetDirectoryName(path);
            }
        }
    }
}